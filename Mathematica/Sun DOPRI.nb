(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33809,        842]
NotebookOptionsPosition[     29750,        779]
NotebookOutlinePosition[     30142,        795]
CellTagsIndexPosition[     30099,        792]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"4.35196", "*", 
    RowBox[{"10", "^", "6"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", "0.030554"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H0", "=", 
   RowBox[{
    RowBox[{"a", "/", "e"}], "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "b", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"H0", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.920765773190689*^9, 3.920765892930168*^9}, {
   3.9207659244018908`*^9, 3.920766040273797*^9}, {3.920766295871632*^9, 
   3.920766301732801*^9}, 3.921366174805401*^9, 3.921366205689704*^9, {
   3.921370086278496*^9, 3.9213700916551423`*^9}, {3.9213715486215005`*^9, 
   3.9213715491681347`*^9}, 3.92137167248694*^9, 3.92197468109088*^9, 
   3.921975063488233*^9, 3.923787157661364*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"8a604118-648d-423d-942e-214598b6e6a6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`"},
     {"0.`", "132969.78584`", "0.`"},
     {"0.`", "0.`", "4.35196`*^6"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.921370504748014*^9, 3.921370506482476*^9}, 
   3.9213715758045535`*^9, 3.921371674533905*^9, 3.92137197974677*^9, 
   3.921972153288046*^9, 3.921974457867139*^9, 3.9219746861835413`*^9, 
   3.9219750650362473`*^9, 3.923787034010357*^9, 3.9237871600652237`*^9, 
   3.923790615781505*^9, 3.9243883249301343`*^9, 3.9243943874813213`*^9, 
   3.924394994628158*^9, 3.924395488170001*^9, 3.924397478925002*^9, 
   3.924399652469195*^9, 3.925586241559989*^9},
 CellLabel->
  "Out[11]//MatrixForm=",ExpressionUUID->"bfacd300-14bf-4fd3-8057-\
38547f6c64df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Gamma]", "=", 
   RowBox[{"6.5956", "*", 
    SuperscriptBox["10", "4"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "10.54"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "[", "\[Xi]_", "]"}], ":=", 
  RowBox[{"\[Gamma]", "*", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "*", "n", " ", "*", "\[Xi]"}], 
     ")"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s12", "=", 
   RowBox[{"Sqrt", "[", "0.308", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s23", "=", 
   RowBox[{"Sqrt", "[", "0.437", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s13", "=", 
   RowBox[{"Sqrt", "[", "0.0234", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c12", "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "-", 
     SuperscriptBox["s12", "2"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c23", "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "-", 
     SuperscriptBox["s23", "2"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c13", "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "-", 
     SuperscriptBox["s13", "2"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["c13", "2"], "*", 
        SuperscriptBox["c12", "2"]}], ",", 
       RowBox[{"c12", "*", "s12", "*", 
        SuperscriptBox["c13", "2"]}], ",", 
       RowBox[{"c12", "*", "c13", "*", "s13"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c12", "*", "s12", "*", 
        SuperscriptBox["c13", "2"]}], ",", 
       RowBox[{
        SuperscriptBox["s12", "2"], "*", 
        SuperscriptBox["c13", "2"]}], ",", 
       RowBox[{"s12", "*", "c13", "*", "s13"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c12", "*", "s13", "*", "c13"}], ",", 
       RowBox[{"s12", "*", "c13", "*", "s13"}], ",", 
       SuperscriptBox["s13", "2"]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"W", "//", "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9207662002643147`*^9, 3.920766314315979*^9}, {
   3.920766350683372*^9, 3.920766407610578*^9}, 3.9207666177193003`*^9, {
   3.920766649172926*^9, 3.920767150138604*^9}, {3.920768877551672*^9, 
   3.920768879184016*^9}, {3.921365660790681*^9, 3.9213657303211136`*^9}, {
   3.9213657835645075`*^9, 3.9213657850176497`*^9}, {3.9213659558439026`*^9, 
   3.921365974717764*^9}, {3.9213660511305094`*^9, 3.9213660961215706`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"53a0234c-5c6a-4007-af61-bc316922df51"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.6758071999999999`", "0.4508635491455923`", "0.1257532841718259`"},
     {"0.4508635491455923`", "0.30079279999999997`", "0.0838960757127531`"},
     {"0.1257532841718259`", "0.0838960757127531`", "0.0234`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9213659173375897`*^9, 3.9213659231669683`*^9}, {
   3.921365958078454*^9, 3.9213659953808146`*^9}, 3.9213661046853724`*^9, {
   3.9213661851198025`*^9, 3.921366187494954*^9}, {3.9213662197549686`*^9, 
   3.921366221537509*^9}, 3.9213670694213257`*^9, 3.921370095453188*^9, 
   3.9213705127803626`*^9, 3.9213715807906475`*^9, 3.921371676150642*^9, 
   3.9213719824824395`*^9, 3.9219721567560167`*^9, 3.921974461271187*^9, 
   3.921974687782806*^9, 3.92197506727334*^9, 3.923787036610011*^9, 
   3.92378716243267*^9, 3.923790617619734*^9, 3.924388329979953*^9, 
   3.9243944032610064`*^9, 3.924394997527854*^9, 3.924395489464053*^9, 
   3.924397480581142*^9, 3.92439964870759*^9, 3.925586246356266*^9},
 CellLabel->
  "Out[22]//MatrixForm=",ExpressionUUID->"20ba9744-5b18-4ce6-ab8b-\
436492efb3e5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DOPRICoeffs", "[", 
    RowBox[{"5", ",", "p_"}], "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", "/", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"3", "/", "40"}], ",", 
           RowBox[{"9", "/", "40"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"44", "/", "45"}], ",", 
           RowBox[{
            RowBox[{"-", "56"}], "/", "15"}], ",", 
           RowBox[{"32", "/", "9"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"19372", "/", "6561"}], ",", 
           RowBox[{
            RowBox[{"-", "25360"}], "/", "2187"}], ",", 
           RowBox[{"64448", "/", "6561"}], ",", 
           RowBox[{
            RowBox[{"-", "212"}], "/", "729"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"9017", "/", "3168"}], ",", 
           RowBox[{
            RowBox[{"-", "355"}], "/", "33"}], ",", 
           RowBox[{"46732", "/", "5247"}], ",", 
           RowBox[{"49", "/", "176"}], ",", 
           RowBox[{
            RowBox[{"-", "5103"}], "/", "18656"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"35", "/", "384"}], ",", "0", ",", 
           RowBox[{"500", "/", "1113"}], ",", 
           RowBox[{"125", "/", "192"}], ",", 
           RowBox[{
            RowBox[{"-", "2187"}], "/", "6784"}], ",", 
           RowBox[{"11", "/", "84"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"35", "/", "384"}], ",", "0", ",", 
         RowBox[{"500", "/", "1113"}], ",", 
         RowBox[{"125", "/", "192"}], ",", 
         RowBox[{
          RowBox[{"-", "2187"}], "/", "6784"}], ",", 
         RowBox[{"11", "/", "84"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "5"}], ",", 
         RowBox[{"3", "/", "10"}], ",", 
         RowBox[{"4", "/", "5"}], ",", 
         RowBox[{"8", "/", "9"}], ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"71", "/", "57600"}], ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "71"}], "/", "16695"}], ",", 
         RowBox[{"71", "/", "1920"}], ",", 
         RowBox[{
          RowBox[{"-", "17253"}], "/", "339200"}], ",", 
         RowBox[{"22", "/", "525"}], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "40"}]}], "}"}]}], "}"}], ",", "p"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9213659098363543`*^9, 3.921365920035966*^9}, 
   3.924394379253542*^9, 3.924394803350917*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"0f7a5a91-9f65-4033-b18a-74a544d07a95"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", "\[Xi]_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Psi]1", "[", "\[Xi]", "]"}], ",", 
    RowBox[{"\[Psi]2", "[", "\[Xi]", "]"}], ",", 
    RowBox[{"\[Psi]3", "[", "\[Xi]", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.92076845595463*^9, 3.920768542105796*^9}, {
  3.9243943758327312`*^9, 3.924394377414596*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"4283aa68-a8b0-444d-ab93-e94f8aa6626f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[ImaginaryI]", "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Psi]", "[", "\[Xi]", "]"}], ",", "\[Xi]"}], "]"}]}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"H0", "+", 
           RowBox[{
            RowBox[{"u", "[", "\[Xi]", "]"}], "*", "W"}]}], ")"}], ".", 
         RowBox[{"\[Psi]", "[", "\[Xi]", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", "0.1", "]"}], "==", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c12", " ", "c13"}], ",", 
          RowBox[{"s12", " ", "c13"}], ",", " ", "s13"}], "}"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\[Psi]1", ",", "\[Psi]2", ",", "\[Psi]3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Xi]", ",", "0.1", ",", "0.5"}], "}"}], ",", " ", 
     RowBox[{"Method", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<ExplicitRungeKutta\>\"", ",", 
        RowBox[{"\"\<Coefficients\>\"", "->", "DOPRICoeffs"}], ",", 
        RowBox[{"\"\<DifferenceOrder\>\"", "->", "5"}], ",", 
        RowBox[{"\"\<StiffnessTest\>\"", "->", "False"}]}], "}"}]}], ",", 
     RowBox[{"StartingStepSize", "->", "0.25"}], ",", 
     RowBox[{"MaxSteps", "->", "Infinity"}], ",", 
     RowBox[{"MaxStepFraction", "->", 
      RowBox[{"1", "/", "12"}]}], ",", 
     RowBox[{"WorkingPrecision", "->", "MachinePrecision"}], ",", 
     RowBox[{"AccuracyGoal", "->", "Infinity"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9207672268920307`*^9, 3.9207672380374613`*^9}, {
   3.920767340427898*^9, 3.920767378900568*^9}, {3.920767412717085*^9, 
   3.9207675081370907`*^9}, {3.9207675923442717`*^9, 3.920767664231278*^9}, {
   3.920767728262321*^9, 3.920767741422245*^9}, {3.92076788255658*^9, 
   3.9207679095385523`*^9}, {3.920768225943058*^9, 3.9207683244529953`*^9}, {
   3.9207684206594057`*^9, 3.920768447859571*^9}, 3.920768595682356*^9, {
   3.920768636954817*^9, 3.9207686798649273`*^9}, {3.9207690029962482`*^9, 
   3.920769045274387*^9}, {3.92076908588592*^9, 3.920769090195321*^9}, {
   3.920769196134974*^9, 3.920769203669951*^9}, {3.921362131564855*^9, 
   3.9213621947513657`*^9}, {3.9213622405575123`*^9, 3.921362272427369*^9}, {
   3.9213623060262723`*^9, 3.9213623230275345`*^9}, {3.9213631195569134`*^9, 
   3.92136312891336*^9}, 3.921366028204785*^9, {3.921371686133207*^9, 
   3.9213716972699027`*^9}, 3.921972147873084*^9, 3.921972371095469*^9, {
   3.921974560389369*^9, 3.9219745622111397`*^9}, {3.921974860603204*^9, 
   3.921974948255904*^9}, 3.92197498719524*^9, {3.9219751315492563`*^9, 
   3.921975132842422*^9}, 3.921975166388782*^9, 3.9237870451787357`*^9, 
   3.9237871269217978`*^9, 3.923790446478051*^9, {3.9237906863184032`*^9, 
   3.9237906874673243`*^9}, 3.9243882447716002`*^9, {3.924388297694423*^9, 
   3.9243883167440205`*^9}, {3.924394694707287*^9, 3.924394731833508*^9}, {
   3.924394766480917*^9, 3.924394768768429*^9}, 3.9243948084576883`*^9, 
   3.9243955002715673`*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"6a1b4169-0e00-432a-a1ea-e5bb109c519d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"uf", "[", "x_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Psi]1", "[", "\[Xi]", "]"}], ",", 
         RowBox[{"\[Psi]2", "[", "\[Xi]", "]"}], ",", 
         RowBox[{"\[Psi]3", "[", "\[Xi]", "]"}]}], "}"}], "/.", "sol"}], 
      "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\[Xi]", "->", "x"}], "}"}]}], "/.", 
    RowBox[{
     RowBox[{"{", "\[Xi]_", "}"}], "->", "\[Xi]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.923787535773014*^9, 3.923787578442037*^9}, {
   3.923787967493094*^9, 3.923787969108103*^9}, {3.9237882008645287`*^9, 
   3.923788207808527*^9}, 3.923789435813843*^9, {3.923789669258409*^9, 
   3.923789670842381*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"4b3257da-e450-43e0-b213-b5f6e90d48a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"quf", "[", "v_", "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"v", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"v", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}], "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.923789672931921*^9, 3.923789726953381*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"578bdc9c-17c3-4ec2-8bcb-a3cb1ef8b667"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"absuf", "[", "v_", "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{"v", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "2"], ",", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{"v", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "2"], ",", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{"v", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], "2"]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.923789441863434*^9, 3.923789570062174*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"93c2e44f-5998-441a-a592-1265d0f1493e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"reimuf", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
     RowBox[{"Im", "[", 
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
     RowBox[{"Re", "[", 
      RowBox[{"v", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
     RowBox[{"Im", "[", 
      RowBox[{"v", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
     RowBox[{"Re", "[", 
      RowBox[{"v", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
     RowBox[{"Im", "[", 
      RowBox[{"v", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.923788213074066*^9, 3.923788218991671*^9}, {
   3.923788260847193*^9, 3.923788368472431*^9}, 3.923788458540352*^9, {
   3.923788598040929*^9, 3.9237886239804564`*^9}, {3.923788672028542*^9, 
   3.923788741611631*^9}, {3.923788811506811*^9, 3.923788813223217*^9}, {
   3.923788855008031*^9, 3.923788860742895*^9}, {3.923788936256082*^9, 
   3.9237890282444344`*^9}, 3.923789524613709*^9, {3.9237896179194193`*^9, 
   3.9237896232177896`*^9}, 3.9243956480605373`*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"b8175efa-0e60-4c31-ad51-e034e661e6ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"surProb", "[", "v_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     SuperscriptBox["c12", "2"], "*", 
     SuperscriptBox["c13", "2"], "*", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{"v", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["s12", "2"], "*", 
     SuperscriptBox["c13", "2"], "*", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{"v", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["s13", "2"], "*", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{"v", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], "2"]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9237879738840303`*^9, 3.923788039975918*^9}, {
  3.924397358506665*^9, 3.924397408399878*^9}, {3.924397449855073*^9, 
  3.924397450878777*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"eb84690c-da67-4c60-b1b3-e63b7a7a5a86"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"arguf", "[", "v_", "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Arg", "[", 
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
     RowBox[{"Arg", "[", 
      RowBox[{"v", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
     RowBox[{"Arg", "[", 
      RowBox[{"v", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"st", "=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "5"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9243996150113792`*^9, 3.9243996208353653`*^9}, {
  3.926209217315695*^9, 
  3.926209285133299*^9}},ExpressionUUID->"13e8321d-40cf-42b4-bd92-\
b1b730b01819"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dat1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"surProb", "[", 
         RowBox[{"uf", "[", "x", "]"}], "]"}], ",", 
        RowBox[{"reimuf", "[", 
         RowBox[{"uf", "[", "x", "]"}], "]"}], ",", 
        RowBox[{"arguf", "[", 
         RowBox[{"uf", "[", "x", "]"}], "]"}], ",", 
        RowBox[{"absuf", "[", 
         RowBox[{"uf", "[", "x", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"quf", "[", 
          RowBox[{"uf", "[", "x", "]"}], "]"}], "-", "1"}]}], "}"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0.101", ",", "0.5", ",", "st"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.923787684207286*^9, 3.9237877879346037`*^9}, {
   3.9237878208230963`*^9, 3.923787851000153*^9}, {3.9237880526937847`*^9, 
   3.92378806226665*^9}, {3.92378845188857*^9, 3.923788486884944*^9}, 
   3.923788794115898*^9, {3.923788872105013*^9, 3.9237888828479652`*^9}, 
   3.923789047974513*^9, {3.9237893132011347`*^9, 3.9237893149758043`*^9}, {
   3.923789380911744*^9, 3.923789385317919*^9}, {3.9237895790547523`*^9, 
   3.9237895858135767`*^9}, {3.923789700435891*^9, 3.9237897097059517`*^9}, {
   3.923789749922369*^9, 3.923789750425459*^9}, {3.923789848640753*^9, 
   3.923789889999097*^9}, 3.924395504975307*^9, 3.924397412247892*^9, 
   3.924397471920438*^9, 3.924399594838254*^9, 3.925586177228527*^9, 
   3.9255871596476307`*^9, 3.92558728539107*^9, {3.926209291934411*^9, 
   3.926209292405685*^9}},ExpressionUUID->"ba66d81f-eed8-49e8-bf19-\
53d50e709fb6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<DOPRI_0.00001.dat\>\"", ",", "dat1", ",", "\"\<Table\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.923789893509584*^9, 3.923789919694182*^9}, 
   3.924395156491248*^9, {3.9255861865571547`*^9, 3.9255862140021887`*^9}, 
   3.925587164383142*^9, 3.925587286426502*^9, {3.926209299150178*^9, 
   3.9262093440763702`*^9}},ExpressionUUID->"a40f04c3-fb31-45d6-b1fa-\
b4ab07b20fe6"],

Cell[BoxData["\<\"DOPRI_0 00001.dat\"\>"], "Output",
 CellChangeTimes->{3.9237899340192823`*^9, 3.924394536724867*^9, 
  3.924395067069703*^9, 3.9243951071471252`*^9, 3.924395158782177*^9, 
  3.924395656956555*^9, 3.924397768313253*^9, 3.9243998654947557`*^9, 
  3.9255870609890275`*^9, 3.9255871807468987`*^9, 3.925587331750182*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"85c97622-3076-4649-bcbe-84a6743bd3c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"P", " ", "=", " ", 
   RowBox[{
    RowBox[{
     SuperscriptBox["c12", "2"], "*", 
     SuperscriptBox["c13", "2"], "*", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{"res", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["s12", "2"], "*", 
     SuperscriptBox["c13", "2"], "*", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{"res", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["s13", "2"], "*", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{"res", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], "2"]}]}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.921364560968588*^9, 3.9213645966174808`*^9}, {
  3.9213647013759937`*^9, 3.9213647894414787`*^9}, {3.9213648228905115`*^9, 
  3.921364838300167*^9}, {3.921364893736394*^9, 3.921364925216951*^9}, {
  3.9213670366324787`*^9, 3.921367055339919*^9}, {3.9213677555322356`*^9, 
  3.921367775407621*^9}, {3.921369182938939*^9, 3.9213692498283463`*^9}, {
  3.921972277921659*^9, 3.9219722884075117`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"7e9497a2-0254-4cf4-8930-73497a60973f"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"res\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 29, 1, 22947830985840752007, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.924394539372925*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"20704018-80ab-438e-978f-2284a14e9f60"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"res\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 29, 2, 22947830985840752007, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9243945393872957`*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"2d19a58f-fea2-4394-8f0e-03603583b56c"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"res\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 29, 3, 22947830985840752007, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.924394539394505*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"381d2c1a-5184-4b57-9595-b3ac42f2d867"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 29, 4, 22947830985840752007, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.924394539401518*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"c0e7ae85-b5f6-47d8-a096-f10ae902cdc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.6758071999999999`", " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{"res", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "]"}], "2"]}], "+", 
  RowBox[{"0.30079279999999997`", " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{"res", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     "]"}], "2"]}], "+", 
  RowBox[{"0.0234`", " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{"res", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
     "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.921364938735016*^9, 3.921365793676234*^9, 3.9213661421907387`*^9, {
   3.9213661960455847`*^9, 3.9213662245528946`*^9}, 3.9213677476075664`*^9, 
   3.9213677799934783`*^9, 3.921369208691881*^9, 3.921369252798641*^9, 
   3.9213716415265694`*^9, 3.921371949331889*^9, 3.9213722781450553`*^9, 
   3.9219722597567997`*^9, 3.921972307095796*^9, 3.921972454553814*^9, 
   3.9219745501312733`*^9, 3.921974645624206*^9, {3.921974844947995*^9, 
   3.921974965021394*^9}, 3.921975012066272*^9, 3.92197511882894*^9, 
   3.92197515644361*^9, 3.921975188186071*^9, 3.923787246406282*^9, 
   3.924394539406219*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"ae726b8e-e86a-48e4-8ae9-1cfbf6569eac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"q", "=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{"res", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{"res", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{"res", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "]"}], "2"]}]}]], "Input",
 CellChangeTimes->{{3.9213647809734592`*^9, 3.9213647809734592`*^9}, {
   3.9213678244256053`*^9, 3.921367887712643*^9}, 3.9213680199555826`*^9, {
   3.921368298675004*^9, 3.9213683286165915`*^9}, {3.9213687466203847`*^9, 
   3.921368928949562*^9}, {3.9213691035980635`*^9, 3.921369156734536*^9}, {
   3.921972293841848*^9, 3.921972300870614*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"335218ef-8e9c-41de-9a68-4e51b2c24792"],

Cell[BoxData["1.004372675935837`"], "Output",
 CellChangeTimes->{
  3.921371962462962*^9, 3.921372281145152*^9, 3.9219723129644947`*^9, 
   3.921972457304225*^9, 3.921974554214468*^9, 3.921974649221381*^9, {
   3.92197484704746*^9, 3.921974872378048*^9}, {3.921974903073601*^9, 
   3.921974967033659*^9}, 3.921975014103862*^9, 3.921975122160116*^9, 
   3.921975159645944*^9, 3.92197519017455*^9, 3.923787249358266*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"305e9a18-6ce2-4059-b10f-9a2a7beef85b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"q", "-", "1"}]], "Input",
 CellChangeTimes->{{3.921972544053472*^9, 3.9219725450569677`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"46cfda79-9c04-44b9-9c75-b72e54b27907"],

Cell[BoxData["0.0043726759358369005`"], "Output",
 CellChangeTimes->{
  3.9219749716589108`*^9, 3.921975125006773*^9, {3.921975162779477*^9, 
   3.921975191768344*^9}, 3.9237872526076717`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"ce33718a-20ce-4225-a468-830048216240"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.921974969237813*^9, 
  3.9219749783324747`*^9}},ExpressionUUID->"eb8b9414-d091-425f-8b64-\
daf5f1c01a56"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9219749762917023`*^9, 
  3.921974976295498*^9}},ExpressionUUID->"02e51eb8-252c-4ca2-86a4-\
6b948af47203"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.921371953552307*^9, 
  3.9213719596013327`*^9}},ExpressionUUID->"c36469a1-e59d-419d-b259-\
f509ec766e1c"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9213723510954804`*^9, 
  3.9213723510954804`*^9}},ExpressionUUID->"9953a387-d730-425f-b88a-\
0fa87dba79fc"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9213687428238564`*^9, 
  3.9213687442925253`*^9}},ExpressionUUID->"4f5e8a86-45a6-4e41-b931-\
f03d9f6baf2c"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9213698861640353`*^9, 3.921369938293584*^9}, {
   3.92137199728199*^9, 3.921371998195092*^9}, 
   3.9213723491306796`*^9},ExpressionUUID->"7db9df19-041a-4a28-90ac-\
bd509d57e714"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9213719961793966`*^9, 
  3.9213719961793966`*^9}},ExpressionUUID->"98aa4177-f1c6-47bc-9fb4-\
88da6e481f41"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.921362120117744*^9, 
  3.921362120117744*^9}},ExpressionUUID->"bae28811-5b07-40d6-8bd8-\
9b4348bef88d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9207687317028513`*^9, {3.920769214433374*^9, 3.920769248206411*^9}, {
   3.921362096216406*^9, 
   3.9213621293844967`*^9}},ExpressionUUID->"76faed7f-188b-420e-989e-\
7dc63b27c9e4"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9213620875284014`*^9, 
  3.9213620896369114`*^9}},ExpressionUUID->"b1af0ea1-cd44-453a-9c1d-\
1c0ada03c590"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.920768736469195*^9, 3.920768738180929*^9}, 
   3.9213620861507635`*^9},ExpressionUUID->"a52d644b-5951-4d15-8374-\
b968e410dd48"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.921362074020154*^9, 
  3.9213620798976*^9}},ExpressionUUID->"a047ac96-e39d-44f5-830d-c0a575d3cede"]
},
WindowSize->{1200, 623.25},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 for Linux x86 (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"88060387-0612-48fa-a70b-4894e72c494f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1192, 29, 110, "Input",ExpressionUUID->"8a604118-648d-423d-942e-214598b6e6a6"],
Cell[1775, 53, 1121, 26, 80, "Output",ExpressionUUID->"bfacd300-14bf-4fd3-8057-38547f6c64df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2933, 84, 2708, 72, 262, "Input",ExpressionUUID->"53a0234c-5c6a-4007-af61-bc316922df51"],
Cell[5644, 158, 1484, 29, 78, "Output",ExpressionUUID->"20ba9744-5b18-4ce6-ab8b-436492efb3e5"]
}, Open  ]],
Cell[7143, 190, 2790, 76, 110, "Input",ExpressionUUID->"0f7a5a91-9f65-4033-b18a-74a544d07a95"],
Cell[9936, 268, 460, 10, 29, "Input",ExpressionUUID->"4283aa68-a8b0-444d-ab93-e94f8aa6626f"],
Cell[10399, 280, 3173, 62, 74, "Input",ExpressionUUID->"6a1b4169-0e00-432a-a1ea-e5bb109c519d"],
Cell[13575, 344, 870, 22, 29, "Input",ExpressionUUID->"4b3257da-e450-43e0-b213-b5f6e90d48a2"],
Cell[14448, 368, 636, 18, 29, "Input",ExpressionUUID->"578bdc9c-17c3-4ec2-8bcb-a3cb1ef8b667"],
Cell[15087, 388, 688, 20, 31, "Input",ExpressionUUID->"93c2e44f-5998-441a-a592-1265d0f1493e"],
Cell[15778, 410, 1311, 31, 29, "Input",ExpressionUUID->"b8175efa-0e60-4c31-ad51-e034e661e6ae"],
Cell[17092, 443, 992, 28, 29, "Input",ExpressionUUID->"eb84690c-da67-4c60-b1b3-e63b7a7a5a86"],
Cell[18087, 473, 774, 24, 50, "Input",ExpressionUUID->"13e8321d-40cf-42b4-bd92-b1b730b01819"],
Cell[18864, 499, 1639, 35, 29, "Input",ExpressionUUID->"ba66d81f-eed8-49e8-bf19-53d50e709fb6"],
Cell[CellGroupData[{
Cell[20528, 538, 433, 8, 29, "Input",ExpressionUUID->"a40f04c3-fb31-45d6-b1fa-b4ab07b20fe6"],
Cell[20964, 548, 412, 5, 33, "Output",ExpressionUUID->"85c97622-3076-4649-bcbe-84a6743bd3c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21413, 558, 1245, 31, 50, "Input",ExpressionUUID->"7e9497a2-0254-4cf4-8930-73497a60973f"],
Cell[22661, 591, 449, 10, 28, "Message",ExpressionUUID->"20704018-80ab-438e-978f-2284a14e9f60"],
Cell[23113, 603, 451, 10, 28, "Message",ExpressionUUID->"2d19a58f-fea2-4394-8f0e-03603583b56c"],
Cell[23567, 615, 449, 10, 28, "Message",ExpressionUUID->"381d2c1a-5184-4b57-9595-b3ac42f2d867"],
Cell[24019, 627, 449, 10, 28, "Message",ExpressionUUID->"c0e7ae85-b5f6-47d8-a096-f10ae902cdc5"],
Cell[24471, 639, 1281, 27, 33, "Output",ExpressionUUID->"ae726b8e-e86a-48e4-8ae9-1cfbf6569eac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25789, 671, 860, 20, 29, "Input",ExpressionUUID->"335218ef-8e9c-41de-9a68-4e51b2c24792"],
Cell[26652, 693, 497, 7, 33, "Output",ExpressionUUID->"305e9a18-6ce2-4059-b10f-9a2a7beef85b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27186, 705, 196, 3, 29, "Input",ExpressionUUID->"46cfda79-9c04-44b9-9c75-b72e54b27907"],
Cell[27385, 710, 271, 4, 33, "Output",ExpressionUUID->"ce33718a-20ce-4225-a468-830048216240"]
}, Open  ]],
Cell[27671, 717, 154, 3, 29, "Input",ExpressionUUID->"eb8b9414-d091-425f-8b64-daf5f1c01a56"],
Cell[27828, 722, 154, 3, 29, "Input",ExpressionUUID->"02e51eb8-252c-4ca2-86a4-6b948af47203"],
Cell[27985, 727, 154, 3, 29, "Input",ExpressionUUID->"c36469a1-e59d-419d-b259-f509ec766e1c"],
Cell[28142, 732, 156, 3, 29, "Input",ExpressionUUID->"9953a387-d730-425f-b88a-0fa87dba79fc"],
Cell[28301, 737, 156, 3, 29, "Input",ExpressionUUID->"4f5e8a86-45a6-4e41-b931-f03d9f6baf2c"],
Cell[28460, 742, 247, 4, 50, "Input",ExpressionUUID->"7db9df19-041a-4a28-90ac-bd509d57e714"],
Cell[28710, 748, 156, 3, 29, "Input",ExpressionUUID->"98aa4177-f1c6-47bc-9fb4-88da6e481f41"],
Cell[28869, 753, 152, 3, 28, "Input",ExpressionUUID->"bae28811-5b07-40d6-8bd8-9b4348bef88d"],
Cell[29024, 758, 232, 5, 28, "Input",ExpressionUUID->"76faed7f-188b-420e-989e-7dc63b27c9e4"],
Cell[29259, 765, 156, 3, 28, "Input",ExpressionUUID->"b1af0ea1-cd44-453a-9c1d-1c0ada03c590"],
Cell[29418, 770, 177, 3, 28, "Input",ExpressionUUID->"a52d644b-5951-4d15-8374-b968e410dd48"],
Cell[29598, 775, 148, 2, 28, "Input",ExpressionUUID->"a047ac96-e39d-44f5-830d-c0a575d3cede"]
}
]
*)

